(function(){var k=PaymentsPortal2.modules.define;P.when("A").execute(function(d){var a=d.state("apx")||{};if(!a.apxSecondaryViewRegistered){var f=d.$(window);d.declarative("apx-secondary-view","click",function(a){if(a.data.widgetInstanceId){var b=a.data.widgetInstanceId,c=a.data.id||1,h=a.data.header,q=a.data.backButtonText||"Back",l=a.data.hideHeader||!1,n=a.data.alternateBackground||!1,r=a.data.paddingClass||"",w=a.data.inlineContent||a.data.content,g=".pmts-portal-root-"+b,m=".apx-secondary-view-root-"+
b,s="#apx-secondary-view-"+c,x=f.scrollTop(),k=a.$target.closest(g).last();k.hide();g=d.$(m).last();g.length||(k.after('<div class="apx-secondary-view-root-'+b+' pmts-portal-component"></div>'),g=d.$(m));var u=g.find(s);u.remove();m=h?['<div class="a-span8 a-column a-span-last a-text-right">','<h4 id="apx-secondary-view-header-'+c+'">',h,"</h4>\n</div>"].join("\n"):"";g.append(['<div class="a-popover a-popover-secondary a-declarative" data-action="a-popover-a11y" id="apx-secondary-view-'+c+'">','<div class="a-popover-wrapper">',
'<div class="a-popover-header-secondary'+(l?" a-popover-no-header":"")+'">','<div class="a-row">','<div class="'+(h?"a-span4":"a-span12 a-span-last")+' a-column">','<a class="a-declarative" data-action="apx-secondary-view-close"  href="#" data-apx-secondary-view-close="{&quot;widgetInstanceId&quot;:&quot;'+b+"&quot;, &quot;scrollTop&quot;:"+x+", &quot;id&quot;:&quot;"+c+'&quot;}">','<i class="a-icon a-icon-page-back"></i>\n<h4>',q||"Back","</h4>\n</a>\n</div>",m,"</div>\n</div>",'<div class="a-popover-inner'+
(n?" a-color-alternate-background":"")+'">','<div class="a-popover-header-spacing'+(l?" a-popover-no-header":"")+'"></div>','<div class="a-container a-secondary-view-inner'+r+'" id="apx-secondary-view-content-'+c+'">',w,"</div>\n</div>\n</div>\n</div>"].join("\n"));u=g.find(s);b=function(){var c=d.viewport();u.width(c.width);u.css("min-height",c.height);u.find(".a-popover-wrapper, .a-popover-inner").css("min-height",c.height)};b();d.on("resize",b);u.show().css("visibility","visible").removeClass("a-popover-hidden");
f.scrollTop(0)}a.$event.preventDefault()});d.declarative("apx-secondary-view-close","click",function(a){var b=a.data.widgetInstanceId,c=a.data.id,h=a.data.scrollTop;b&&c&&(c=a.$target.closest("#apx-secondary-view-"+c).last(),b=d.$(".pmts-portal-root-"+b),c.remove(),b.show(),h&&f.scrollTop(h));a.$event.preventDefault()});a.apxSecondaryViewRegistered=!0;d.state("apx",a)}});k("attributes",["lang","events"],function(d,a){return d.extend({},a,{attributes:{},resetQuietly:function(a){this.attributes={};
if(null!=a)for(var d in a){var b=a[d];void 0!==b&&(this.attributes[d]=b)}},toJSON:function(){return d.clone(this.attributes)},get:function(a){if(d.has(this.attributes,a))return this.attributes[a]},has:function(a){return void 0!==this.get(a)},set:function(a,e){var b;d.isString(a)?(b={},b[a]=e):b=a;var c,h,q,l;for(l in b)h=b[l],q=this.get(l),this.isAttributeEqual(l,q,h)||(c||(c={}),c[l]=q,void 0!==h?this.attributes[l]=h:delete this.attributes[l]);if(c){for(var n in c)d.has(c,n)&&(h=this.get(n),q=c[n],
this.trigger("change:"+n,h,n,this,q));this.trigger("change",this)}},unset:function(){var a={};if(0===arguments.length)for(var e in this.attributes)d.has(this.attributes,e)&&(a[e]=void 0);else d.forEach(arguments,function(b){a[b]=void 0});return this.set(a)},reset:function(a){var e={},b;for(b in this.attributes)d.has(this.attributes,b)&&(e[b]=void 0);null!=a&&d.extend(e,a);return this.set(e)},isAttributeEqual:function(a,d,b){return d===b},watch:function(){var a,d,b,c;if(2===arguments.length)for(a in b=
arguments[0],d=arguments[1],d)c=d[a],this.on("change:"+a,b,c);else a=arguments[0],b=arguments[1],c=arguments[2],this.on("change:"+a,b,c);return this}})});k("aui-helper",["jQuery","lang","css-utils","AUI!P"],function(d,a,f,e){return{_dropdown:function(b){return{getControlElement:function(){return this._getSpan().prev()},_getSpan:function(){return b},error:function(c){var b=this._getSpan();if("undefined"!==typeof c)b.toggleClass("a-form-error a-button-error",c);else return b.hasClass("a-button-error")||
b.hasClass("a-form-error")},val:function(c){var b=this.getControlElement(),a=this._getSpan();if("undefined"!==typeof c)e.when("a-dropdown").execute(function(e){var f=b.attr("id");d.isFunction(e.getSelect)?e.getSelect(f).setValue(c):(b.val(c),d(a.find(".a-dropdown-prompt")[0]).html(c))});else return b.val()},getOptionTextForValue:function(c){var b=this.getControlElement();return b?b.find("[value="+c+"]").first().text():""},toggleDisabled:function(c){if(e){var b=this._getSpan(),a=this.getControlElement();
"undefined"===typeof c&&(c=!f.hasAUIDisabledButtonClass(a));e.when("a-dropdown").execute(function(e){var n=a.attr("id"),r=c?"disabled":"normal";d.isFunction(e.getSelect)?e.getSelect(n).update({status:r}):f.toggleDisabledElement(b,!c)})}},isEnabled:function(){return!f.hasAUIDisabledButtonClass(this._getSpan())}}},_radio:function(b,c){var a=b.getDOMElementsByPrefix(c+"-");return{getControlElement:function(){return a},error:function(c){},val:function(c){if("undefined"!==typeof c){var b=a.filter(function(b,
a){return a.value===c})[0];b&&(b.checked=!0)}else return a.filter(":checked").val()},isEnabled:function(){return!this.getControlElement().prop("disabled")},isChecked:function(){return this.getControlElement()[0].checked}}},_textInput:function(b,c){return{getControlElement:function(){return b},getParent:function(){return b.parent()},error:function(c){var b=this.getParent(),b=b.hasClass("a-input-text-wrapper")?b:this.getControlElement();if("undefined"!==typeof c)b.toggleClass("a-form-error",c);else return b.hasClass("a-form-error")},
val:function(c){if("undefined"!==typeof c)b.val(c);else return b.val()},isEnabled:function(){return!b.hasClass("a-form-disabled")}}},_generic:function(b){return{getControlElement:function(){return b},error:function(c){if("undefined"!==typeof c)b.toggleClass("a-form-error",c);else return b.hasClass("a-form-error")},val:function(c){if("undefined"!==typeof c)b.val(c);else return b.val()},isEnabled:function(){return!b.hasClass("a-form-disabled")}}},getAUITagHelper:function(b,c){switch(b.getElementTagType(c)){case "RadioButtonTag":return this._radio(b,
c);case "DropdownTag":return this._dropdown(b.getDOMElement(c));case "TextInputTag":return this._textInput(b.getDOMElement(c));default:return this._generic(b.getDOMElement(c))}},getFormAlertsContainerHelper:function(b,c){return{render:function(a){a&&a.length&&0<a.length?("inline"===b?this._renderInlineAlerts(a):this._renderBoxAlerts(a),f.showElement(c)):(d(c.find("ul")).empty(),f.hideElement(c))},_renderInlineAlerts:function(b){c.find(".pmts-error-message-inline").remove();var d=c.find(".pmts-error-message-inline-template");
a.forEach(b,function(b){var a=d.clone().removeClass("pmts-error-message-inline-template").addClass("pmts-error-message-inline");a.find("p").text(b.localizedMessageString);a.appendTo(c)})},_renderBoxAlerts:function(b){var e=d(c.find("ul")).empty();a.forEach(b,function(c){d("<span>").attr("class","a-list-item").text(c.localizedMessageString).appendTo(d("<li>").appendTo(e))})}}},dynamicTriggeredWidgetEvent:function(b){var c=d("form"),a=document.createElement("input");a.name="ppw-widgetEvent:"+b;a.type=
"hidden";c.append(a);c.submit()},getExpanderHelper:function(b){var c;return{isExpanded:function(){return"true"===this.getContainer().find("div.a-expander-inline-content").attr("aria-expanded")},getContainer:function(){return c||(c=b.closest("div.a-expander-inline-container"))}}}}});(function(){var d=null;"undefined"!==typeof AmazonUIPageJS?d=AmazonUIPageJS:"undefined"!==typeof P&&(d=P);d?(k("AUI!P",[],function(){return d}),d.when("A").execute(function(a){k("AUI!A",[],function(){return a})})):(k("AUI!P",
[],function(){return null}),k("AUI!A",[],function(){return null}))})();k("base",["lang"],function(d){function a(b,c){return function(){b.apply(this,arguments);c.apply(this,arguments)}}function f(b,c){for(var h=c.length-1;0<=h;h--){var e=c[h];if(d.has(e,"constructor"))return e.constructor;if(d.has(e,"initialize"))return 0<h&&(b=f(b,d.slice(c,0,h))),a(b,e.initialize)}return function(){b.apply(this,arguments)}}var e=function(){};e.extend=function(){var b=f(this,arguments);b.extend=this.extend;b.prototype=
d.create(this.prototype);b.prototype.constructor=b;for(var c=0,a=arguments.length;c<a;c++){var e=arguments[c],l;for(l in e)d.has(e,l)&&"constructor"!==l&&"initialize"!==l&&(b.prototype[l]=e[l])}return b};return e});k("cc-spacing",[],function(){return{fixSpacing:function(d){d=d.replace(/\s/g,"");0<d.length&&(d=d.match(/^3[47]/)?[d.substr(0,4),d.substr(4,6),d.substr(10,5),d.substr(15)].join(" ").trim():d.match(RegExp(".{1,4}","g")).join(" "));return d},fixCaret:function(d,a,f,e){if(a&&f)if(a.length===
f.length+2){if(e===f.length||" "===f.charAt(e))d+=1}else a.length===f.length+1&&e<f.length&&" "===f.charAt(e)&&(d+=1);return d}}});k("component",["base","jQuery","lang","aui-helper","AUI!P"],function(d,a,f,e,b){return d.extend({initialize:function(c,b){this.id=b.id;this.widget=c;this._elementReferences=b.elementReferences;this._elementDOMEventMethodBindings=b.elementDOMEventMethodBindings;this._elementReferenceTagType=b.elementReferenceTagType;this.data=b.data},initializeOnReady:function(){this.bindToEvents();
this._processDOMElementEventMethodBindings();this.bindToElements();this._handleScrollToPosition(this.data);this._setFocusOnElement(this.data)},_processDOMElementEventMethodBindings:function(){var c=this;c._elementDOMEventMethodBindings&&f.forEach(c._elementDOMEventMethodBindings,function(b){if(b.method in c)a("#"+b.elementId).bind(b.event,f.bind(c[b.method],c));else throw Error("Could not find method "+b.method+" on component.");})},getDOMElement:function(b){b=this._elementReferences[b];var h=a("#"+
b);return b&&1===h.length?h:a([])},getDOMElements:function(){var b=a([]);f.forEach(f.keys(this._elementReferences),function(a){b=b.add(this.getDOMElement(a))},this);return b},getDOMElementsByPrefix:function(b){var h=a([]);f.forEach(f.keys(this._elementReferences),function(a){f.startsWith(a,b)&&(h=h.add(this.getDOMElement(a)))},this);return h},getElementTagType:function(b){return this._elementReferenceTagType[b]},_setFocusOnElement:function(b){void 0!==b&&void 0!==b.focusElementIdReference&&this.widget.focusToElement(this._elementReferences[b.focusElementIdReference])},
_handleScrollToPosition:function(b){void 0!==b&&void 0!==b.scrollOption&&("toElementByReference"===b.scrollOption?this.widget.scrollToElementOnInitialize(this._elementReferences[b.scrollElementIdReference]):"toTopOfThePage"===b.scrollOption&&this.widget.scrollToTopOfThePage())},bindToElements:function(){},bindToEvents:function(){},onExpanderClick:function(b){b=a(b.currentTarget);b=e.getExpanderHelper(b);var h=b.getContainer();if(h.length&&!b.isExpanded()){this.widget.scrollToElement(h);var d=h.find("input[type='text'], input[type='tel']").first();
window.setTimeout(function(){d.focus()},150)}},detach:function(){var b=this;f.forEach(f.keys(b._elementReferences),function(a){b.getDOMElement(a).unbind()})},getRootDOMElements:function(){return a(".pmts-portal-components-"+this.id)},widgetState:null,getWidgetState:function(b){this.widgetState||(this.widgetState=this.getDOMElement(b).closest("form").find("input[name=ppw-widgetState]").val());return this.widgetState},isWidgetRootComponent:function(){return this.getRootDOMElements().is(this.widget.getRootDOMElements())},
registerSecondaryView:function(a){var h=this,d=this.widget,e=this.getDOMElement(a);b.when("a-secondary-view").execute(function(b){if(b=b.get(e)){var f={instance:b,reference:a};h.secondaryViews=h.secondaryViews||[];h.secondaryViews.push(f);a===d.get("activeSecondaryViewReference")&&b.show()}});b.when("a-popover-util").execute(function(b){h.popoverUtilModule=b});d.on("widget:clean",this,function(){d.unset("activeSecondaryViewReference");h.popoverUtilModule&&h.secondaryViews&&f.forEach(h.secondaryViews,
function(b){var a=b.instance;a.isActive()&&(a.unlock().hide(),h.popoverUtilModule.trigger("dismiss",a),d.set("activeSecondaryViewReference",b.reference))})})}})});k("config",[],function(){var d={useNativeFunctions:!0,useNativeHasOwnProperty:!0};return{getAttribute:function(a){var f=("undefined"!==typeof window.APXConfig?window.APXConfig:"undefined"!==typeof window.PaymentsPortal2Config?window.PaymentsPortal2Config:{})[a];return"undefined"!==typeof f?f:d[a]}}});k("continuable-component",["component",
"continuable","clog","public-event-registry"],function(d,a,f,e){return d.extend(a,{CONTINUABLE_EVENT_NAME:"WidgetContinuableStatusEvent",initialize:function(b,a){e.register(this.CONTINUABLE_EVENT_NAME);this.fireWidgetContinuableStatusEvent=a.data.fireWidgetContinuableStatusEvent;this._watchContinuable()},_watchContinuable:function(){var b=this;this.watchContinuable(this,function(a){var d={widgetName:b.widget.type,isContinuable:a};b.widget.log(d);b.fireWidgetContinuableStatusEvent&&"undefined"!==typeof a&&
b.widget.trigger(this.CONTINUABLE_EVENT_NAME,d)})}})});k("continuable",["lang","attributes"],function(d,a){return d.extend({},a,{setContinuable:function(a){this.set("ContinuableAttribute",a)},getContinuable:function(){return this.get("ContinuableAttribute")},watchContinuable:function(){var a,d;2===arguments.length?(a=arguments[0],d=arguments[1]):(a=this,d=arguments[0]);this.watch("ContinuableAttribute",a,d)}})});k("css-utils",[],function(){var d=function(b){b.addClass("a-hidden aok-hidden");b.hide()},
a=function(b){b.removeClass("a-hidden aok-hidden");b.show()},f=function(b){b.addClass("a-button-disabled")},e=function(b){b.removeClass("a-button-disabled")},b=function(b){return b.hasClass("a-hidden")||b.hasClass("aok-hidden")},c=function(b){return b.hasClass("a-button-disabled")};return{hideElement:d,showElement:a,toggleElement:function(c,e){"undefined"===typeof e&&(e=b(c));e?a(c):d(c)},hasAUIHiddenClass:b,hasAUIDisabledButtonClass:c,disableElement:f,enableElement:e,toggleDisabledElement:function(b,
a){"undefined"===typeof a&&(a=c(b));a?e(b):f(b)},disableTextInput:function(b){b.addClass("a-form-disabled");b.prop("disabled",!0)},enableTextInput:function(b){b.removeClass("a-form-disabled");b.prop("disabled",!1)},makeTextInputReadOnly:function(b){b.addClass("a-form-disabled");b.prop("readonly",!0)},makeTextInputReadWrite:function(b){b.removeClass("a-form-disabled");b.prop("readonly",!1)},isTextInputReadOnly:function(b){return b.hasClass("a-form-disabled")&&b.is("[readonly]")},setElementBackgroundImage:function(b,
a,c){c?b.css("background","url('"+a+"')"+c):b.css("background-image","url('"+a+"')")}}});k("mixins/disable-component",["lang"],function(d){return d.extend({},{_disabled:!1,toggleDisabled:function(){this.setDisabled(!this._disabled)},isDisabled:function(){return this._disabled},setDisabled:function(a){arguments.length||(a=!0);if(a!==this._disabled){this._disabled=a;var d=this.getDOMElements();a?(d.find("input").andSelf().filter("input").prop("disabled",!0),d.find("span.a-color-base").removeClass("a-color-base").addClass("a-color-tertiary")):
(d.find("input").andSelf().filter("input").prop("disabled",!1),d.find("span.a-color-tertiary").removeClass("a-color-tertiary").addClass("a-color-base"));this.onDisabledChange(a)}},onDisabledChange:function(a){}})});k("events",["lang","AUI!A"],function(d,a){function f(a,b){d.every(a,function(a){return a.callback.apply(a.thisArg,b)!==PaymentsPortal2.events.STOP_EVENT_PROCESSING},this)}"undefined"===typeof PaymentsPortal2.events&&(PaymentsPortal2.events={},PaymentsPortal2.events.STOP_EVENT_PROCESSING=
"STOP_EVENT_PROCESSING");return{on:function(){var a,b,c;if(2===arguments.length){b=arguments[0];var h=arguments[1];for(a in h)c=h[a],this.on(a,b,c);return this}a=arguments[0];b=arguments[1];c=arguments[2];if(null==b)throw new TypeError("Events.on: thisArg must not be null or undefined");if(!d.isFunction(c))throw new TypeError("Events.on: callback must be a function");h=this.listeners;h||(h=this.listeners={});d.has(h,a)||(h[a]=[]);h[a].push({callback:c,thisArg:b});return this},auiListeners:{},onAui:function(d,
b){a&&(this.auiListeners[d]=this.auiListeners[d]||[],this.auiListeners[d].push(b),a.on(d,b))},offAui:function(e,b){if(a)if(null==e){for(var c in this.auiListeners)this.auiListeners.hasOwnProperty(c)&&d.forEach(this.auiListeners[c],function(b){a.off(c,b)});this.auiListeners={}}else a.off(e,b)},off:function(a,b,c){if(null==a&&null==b&&null==c)return delete this.listeners,this;var h=this.listeners;if(!h)return this;a=null==a?d.keys(h):[a];d.forEach(a,function(a){d.has(h,a)&&(h[a]=d.filter(h[a],function(a){return null!=
b&&b!==a.thisArg&&b!==a.thisArg.widget||null!=c&&c!==a.callback}))});return this},trigger:function(a){var b=this.listeners;if(!b)return this;var c=d.slice(arguments,1);d.has(b,"all")&&f.call(this,b.all,d.merge([a],c));d.has(b,a)&&f.call(this,b[a],c);return this},triggerContinue:function(a,b){b&&b.submissionParameters&&b.submissionParameters.push({name:"ppw-jsEnabled",value:!0});this.trigger(a,b)}}});k("events/form-submitted-event",[],function(){return"FormSubmitted"});k("events/spinner-events",[],
function(){return{hideSpinner:"HideSpinner",showSpinner:"ShowSpinner"}});k("events/workflow-state-event",[],function(){return"WorkflowState"});k("form-component",["component","form","keyboard","lang"],function(d,a,f,e){return d.extend({initialize:function(b,c){this.form=new a(this,c.data.formQualifier,c.data.formDefinition)},bindFormSubmissionHandler:function(b,a,d){var q=this;q.getDOMElement(b).click(e.bind(d,q));q.getDOMElement(a).bind("keypress",function(b){if(b.which===f.keys.VK_RETURN)return d.call(q)})},
getFormSubmissionParameters:function(b,a){var d="string"===typeof b?this.getDOMElement(b):b,e=d.find("form").andSelf().filter("form"),e=0!==e.length?e.serializeArray():d.find("input, select").serializeArray(),d=1<arguments.length?("string"===typeof a?this.getDOMElement(a):a).find("input[type=submit]").attr("name"):d.find("input[type=submit]")[0].name;e.push({name:d,value:"Submit"});return e}})});k("form-constants",[],function(){return{WIDGET_EVENT_KEY:"ppw-widgetEvent",KEY_VALUE_SEPARATOR:":"}});
k("form-helper",["lang","jQuery","form-constants"],function(d,a,f){return{onSubmit:function(d,b){d.each(function(){var c=a(this),d=null;c.find("input[type=submit]").click(function(b){d=a(b.target)});c.submit(function(a){b(c,a,d);d=null})})},serializeObject:function(a){return d.reduce(a.serializeArray(),function(b,a){b[a.name]=a.value;return b},{})},ensureWidgetEventInput:function(a,b){var c=f.WIDGET_EVENT_KEY+f.KEY_VALUE_SEPARATOR,h=d.startsWith(b,c)?b:c+b,q=function(){return a.find("input[type='hidden'][name^='"+
c+"']")};q().not("[name^='"+h+"']'").remove();q().length||a.append("<input name="+h+" type=hidden />")}}});k("form-model",["base","lang","validation-functions"],function(d,a,f){return d.extend({initialize:function(a){this.constraints=a.constraints;this.fields=a.fields;this.validationEvent=a.validationEvent;this.actionEvent=a.actionEvent;this.additionalData={}},validateForm:function(d){var b={},c=[];a.forEach(this.constraints,function(a){if(!b[a.field]&&!this.evalValidator(a,d)){b[a.field]=!0;var f=
{field:a.field,validation:a.validation,messageStringId:a.failureMessageStringId};this.validationEvent&&this.actionEvent&&(f.fieldMetricValueType=a.metricValueType,f.fieldValue=this._getFieldValue(a,d));c.push(f)}},this);return c},_getFieldValue:function(a,b){var c="CRITICAL_OR_RESTRICTED_VALUE";if(!a.isCriticalOrRestricted)if(c=this.fields[a.field],"expirationDate"===a.field)var d=b[c.dayParameterName],c=b[c.yearParameterName]+"-"+b[c.monthParameterName]+"-"+("undefined"===typeof d?"01":d);else c=
b[c.defaultParameterName];return c},evalValidator:function(a,b){var c=f[a.validation];return c?c.call(null,this,b,this.fields[a.field],a.parameters):!0},registerAdditionalData:function(a,b){"string"===typeof a&&(this.additionalData[a]=b)},getAdditionalData:function(a){return this.additionalData[a]}})});k("form","base css-utils lang jQuery form-model aui-helper".split(" "),function(d,a,f,e,b,c){var h=[/^addCreditCardVerificationNumber[0-9]*$/];return d.extend({initialize:function(a,c,d){this.component=
a;this.formQualifier=c;this.formModel=new b(d);this.fields=d.fields},validateForm:function(b){this.clearValidationErrors();var a=this.getFormValues(),a=this._getLocalizedErrorMessages(this.formModel.validateForm(a));0<a.length&&!b&&this.renderErrorMessages(a);return a},renderErrorMessages:function(a){var b=this,d=[],e=[],h=[],g={};f.forEach(a,function(a){a.field&&(g[a.field]||(g[a.field]=[]),g[a.field].push(a),b.blameFormField(a.field,!0));a.validation&&a.fieldMetricValueType&&a.fieldValue&&(d.push(a.validation),
e.push(a.fieldMetricValueType),h.push(a.fieldValue))});var m=this._getFormFieldAlertContainers();f.forEach(f.keys(m),function(a){c.getFormAlertsContainerHelper("inline",m[a]).render(g[a])});var s=this._getFormAlertsContainer();void 0!==s.domElement&&c.getFormAlertsContainerHelper(s.messageDisplayType,s.domElement).render(a)},_submitValidationMetrics:function(a,b,c){a&&b&&c&&this.component.widget.continueRequest({"ppw-widgetEvent":this.formModel.validationEvent,"ppw-actionEvent":this.formModel.actionEvent,
"ppw-validations":a,"ppw-valueTypes":b,"ppw-values":c,"ppw-widgetState":this.component.widget.options.serializedState},{success:function(){}})},_getFormAlertsContainer:function(){var a=this.component.getDOMElement("errorMessagesBoxContainer");return 0<a.length?{domElement:a,messageDisplayType:"box"}:{domElement:this.component.getDOMElement("errorMessagesInlineContainer"),messageDisplayType:"inline"}},_getFormFieldAlertContainers:function(){var a=this,b={};f.forEach(f.keys(this.fields),function(c){var d=
a.component.getDOMElement("errorMessagesInlineContainer-"+c);d.length&&(b[c]=d)});return b},_getLocalizedErrorMessages:function(a){var b=this;return f.map(a,function(a){return{field:a.field,validation:a.validation,fieldMetricValueType:a.fieldMetricValueType,fieldValue:a.fieldValue,messageStringId:a.messageStringId,localizedMessageString:b.component.widget.getLocalizedString(a.messageStringId)}})},getFormValues:function(){var a={},b=this;f.forEach(this._getParameterNames(),function(c){b.getAUITagHelperForParameter(c).isEnabled()&&
(a[c]=b.getAUITagHelperForParameter(c).val())});a.widgetCreationEpochMilliseconds=this.component.widget.widgetCreationEpochMilliseconds;return a},getQualifiedParameterName:function(a){if(this.formQualifier){var b=!1;h.forEach(function(c){b=b||c.test(a)});return b?a:this.formQualifier+"_"+a}return a},getAUITagHelperForParameter:function(a){return c.getAUITagHelper(this.component,this.getQualifiedParameterName(a))},bindToParameter:function(a,b){var c=[];Array.prototype.push.apply(c,arguments);c.shift();
var d=this.getAUITagHelperForParameter(a).getControlElement();d.bind.apply(d,c)},_getParameterNames:function(a){if(a){var b=this.fields[a];return f.map(f.keys(b),function(a){return b[a]})}var c=[],d=this;f.forEach(f.keys(this.fields),function(a){var b=d.fields[a];a=f.keys(b);f.forEach(a,function(a){c.push(b[a])})});return c},blameFormField:function(a,b){var c=this,d=this._getParameterNames(a);f.forEach(d,function(a){c.getAUITagHelperForParameter(a).error(b)})},resetErrors:function(){this.clearValidationErrors();
a.hideElement(this.component.getDOMElement("errorMessagesBoxContainer"))},clearValidationErrors:function(){var a=this;f.forEach(f.keys(this.fields),function(b){a.blameFormField(b,!1)})},displayErrorMessage:function(b,c){this.blameFormField(b,!0);a.showElement(c)},resetErrorMessage:function(b,c){this.blameFormField(b,!1);a.hideElement(c)}})});k("global-event-bus",["lang","events"],function(d,a){return d.extend({},a)});PaymentsPortal2.modules.when(["AUI!P"],function(d){function a(a){k("jQuery",[],function(){return a})}
d?d.when("jQuery").execute(a):"undefined"!==typeof jQuery&&a(jQuery)});k("keyboard",[],function(){return{keys:{VK_BACKSPACE:8,VK_RETURN:13,VK_DELETE:46,VK_ZERO:48,VK_NINE:57}}});k("lang",["config"],function(d){var a={id:function(a){return a}},f=Array.prototype.slice,e=Object.prototype.toString;a.slice=function(a){return f.apply(a,f.call(arguments,1))};a.isDefined=function(a){return!("undefined"===typeof a||null===a)};var b=a.isObject=function(a){return Object(a)===a},c=a.isFunction=function(a){return"[object Function]"===
e.call(a)},h=a.isString=function(a){return"[object String]"===e.call(a)};a.isNumber=function(a){return"[object Number]"===e.call(a)};var q=a.extend=function(a){a=Object(a);for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b],z;for(z in d)a[z]=d[z]}return a};a.clone=function(a){return q({},a)};a.merge=function(a){for(var b=1,c=arguments.length;b<c;b++)for(var d=arguments[b],z=0,g=d.length;z<g;z++)a.push(d[z]);return a};a.force=function(a,b){var d=a[b];return c(d)?d.call(a):d};a.time=function(){return(new Date).getTime()};
a.date=function(){return new Date(a.time())};a.intercept=function(a,b,c,d){var g=a[b];a[b]=function(){c.apply(d,arguments);g&&g.apply(this,arguments)};return a};a.NOOP=function(){};a.forEachKeyValue=function(a,b){for(var c in a)r(a,c)&&b(c,a[c])};var l=0;a.newLocalId=function(){return"pmts-id-"+ ++l};a.assert=function(a,b){if(!a)throw Error(b||"Assertion Error");};a.once=function(a){var b=!1,c;return function(){if(b)return c;c=a.apply(this,arguments);b=!0;return c}};a.after=function(a,b){return function(){if(0>=
--a)return b.apply(this,arguments)}};a.leftPad=function(a,b,c){a=String(a);b-=a.length;return 0>=b?a:Array(b+1).join(c)+a};a.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)};a.startsWith=function(a,b){return a.substr(0,b.length)===b};a.keywordFormat=function(a,b){return a.replace(/\{(\w+)\}/g,function(a,c){return"undefined"!==typeof b[c]?b[c]:a})};a.stableSort=function(a,b){var c=y(a,function(a,b){return{index:b,elem:a}});c.sort(function(a,c){var d=b(a.elem,c.elem);return 0===d?a.index-
c.index:d});return y(c,function(a){return a.elem})};var n=d.getAttribute("useNativeFunctions");d=d.getAttribute("useNativeHasOwnProperty");var r,w=Object.prototype.hasOwnProperty;r=w&&d?function(a,b){return w.call(a,b)}:function(a,b){if(!(b in a))return!1;for(var c in a)if(c===b)return!0;return!1};a.has=r;d=Array.isArray;a.isArray=d&&n?d:function(a){return"[object Array]"===e.call(a)};var g;if((d=Object.create)&&n)g=d;else{var m=function(){},s=m.prototype;g=function(a){if(null===a)throw Error("null prototypes are not supported");
if(!b(a))throw new TypeError("prototype must be an object");if(1<arguments.length)throw Error("property descriptors are not supported");m.prototype=a;var c=new m;m.prototype=s;return c}}a.create=g;var x=Function.prototype.bind;a.bind=x&&n?function(a){return x.apply(a,f.call(arguments,1))}:function(a,c){var d=f.call(arguments,2),m=function(){if(this instanceof m){var z=g(a.prototype),y=a.apply(z,d.concat(f.call(arguments)));return b(y)?y:z}return a.apply(c,d.concat(f.call(arguments)))};return m};var k,
u=Array.prototype.forEach;k=u&&n?function(a){u.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);for(var d=0,g=a.length>>>0;d<g;d++)d in a&&b.call(c,a[d],d,a)};a.forEach=k;var v=Array.prototype.filter;a.filter=v&&n?function(a){return v.apply(a,f.call(arguments,1))}:function(a,b,c){var d=[];k(a,function(a,g,m){b.call(c,a,g,m)&&d.push(a)});return d};var y,B=Array.prototype.map;y=B&&n?function(a){return B.apply(a,f.call(arguments,1))}:function(a,b,c){var d=[];k(a,function(a,g,m){d[g]=b.call(c,
a,g,m)});return d};a.map=y;var t=Array.prototype.indexOf;a.indexOf=t&&n?function(a){return t.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);var d=a.length>>>0,g=2<arguments.length?+c:0;0>g&&(g+=d,0>g&&(g=0));for(;g<d;g++)if(g in a&&b===a[g])return g;return-1};var p=Array.prototype.lastIndexOf;a.lastIndexOf=p&&n?function(a){return p.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);var d=a.length>>>0,g=2<arguments.length?+c:d;for(0>g?g+=d:g>d-1&&(g=d-1);0<=g;g--)if(g in a&&b===a[g])return g;
return-1};var A=Array.prototype.reduce;a.reduce=A&&n?function(a){return A.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);var d=a.length>>>0,g=0;if(2>=arguments.length){for(var m=!1;g<d;g++)if(g in a){c=a[g];g++;m=!0;break}if(!m)throw new TypeError("reduce: no initial value specified for empty array");}for(;g<d;g++)g in a&&(c=b.call(null,c,a[g],g,a));return c};var F=Array.prototype.reduceRight;a.reduceRight=F&&n?function(a){return F.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);
var d=(a.length>>>0)-1;if(2>=arguments.length){for(var g=!1;0<=d;d--)if(d in a){c=a[d];d--;g=!0;break}if(!g)throw new TypeError("reduceRight: no initial value specified for empty array");}for(;0<=d;d--)d in a&&(c=b.call(null,c,a[d],d,a));return c};var C=Array.prototype.every;a.every=C&&n?function(a){return C.apply(a,f.call(arguments,1))}:function(a,b,c){a=Object(a);for(var d=0,g=a.length>>>0;d<g;d++)if(d in a&&!b.call(c,a[d],d,a))return!1;return!0};var D=Array.prototype.some;a.some=D&&n?function(a){return D.apply(a,
f.call(arguments,1))}:function(a,b,c){a=Object(a);for(var d=0,g=a.length>>>0;d<g;d++)if(d in a&&b.call(c,a[d],d,a))return!0;return!1};d=Object.keys;a.keys=d&&n?d:function(a){var b=[],c;for(c in a)r(a,c)&&b.push(c);return b};var E=String.prototype.trim;a.trim=E&&n?function(a){return E.apply(a)}:function(a){if(!h(a))throw new TypeError("trim: str must be a string");return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};a.addEventListener=function(a,b,c){a.addEventListener?a.addEventListener(b,c,
!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c};return a});k("localization-utils",[],function(){var d=/\{(\w+)\}/g;return{fillInStringTemplate:function(a,f){for(var e=a,b=d.exec(a);b;){var c=b[0],b=b[1];"string"===typeof f[b]&&(e=e.replace(c,f[b]));b=d.exec(a)}return e}}});k("clog",["lang"],function(d){function a(a){window.console&&window.console.error&&window.console.error(a)}function f(a){return window.Number(a)===a&&0===a%1}function e(a){return"[object String]"===Object.prototype.toString.call(a)}
function b(a){return!0===a||!1===a}function c(a,b){return window.JSON&&window.JSON.stringify?b+window.encodeURIComponent(window.JSON.stringify(a)):b+window.encodeURIComponent(a)}function h(a,b){return b+window.encodeURIComponent(a)}function q(a){a=a();e(a.name)&&"[object Function]"===Object.prototype.toString.call(a.send)&&"isPrimitive"in a&&(v[a.name]=a,++y)}function l(a,b){if(a){b=b||{};var d;if(d=!0===b.dontSendOnBFHit)d=window.ue&&"isBF"in window.ue?window.ue.isBF:(d=window.performance||window.webkitPerformance)&&
d.navigation?2===d.navigation.type:!1;if(!(d||a.length>F)){d=b.client&&b.client in v?b.client:k;try{v[d].send(a,D+E,c,b.chainedClientExecutionOrder)}catch(g){}}}}function n(a){var b;if(b=a)if(b="[object Array]"===Object.prototype.toString.call(a))if(b=0<a.length)if(b=a.length<y)a:{for(b=0;b<a.length;++b)if(!(a[b]in v)){b=!1;break a}else if(!v[a[b]].isPrimitive){b=!1;break a}b=!0}return b}function r(){return(new Date).getTime()}function w(){return window.PaymentsPortal2.widgetStartTime}var g={numberOfTimberLogCalls:0},
m=!1,s=!1,x=!1,k="consoleLoggingClient",u=["ajaxLoggingClient","imageLoggingClient","consoleLoggingClient"],v={},y=0,B={},t="requestId session marketplaceId marketplace service method client".split(" "),p={},A=function(){},F=1900,C=1E3,D="https://fls-devo.vipinteg.amazon.com/",E="/1/payments-portal-log/1/TOP/",G="/1/action-impressions/1/TOP/payments-portal/action/",H=!1,I="",J="";q(function(){function a(){if(window.XDomainRequest){var c=new window.XDomainRequest;c.onerror=A;c.ontimeout=A;c.onprogress=
A;c.onload=A;c.timeout=0;return c}if(window.XMLHttpRequest){c=new window.XMLHttpRequest;if(!("withCredentials"in c))throw"WithCredentials header not found Exception";return c}if(window.ActiveXObject){for(var d=0;d<b.length&&!c;d++)try{c=new window.ActiveXObject(b[d]),b=[b[d]]}catch(g){}return c}}var b="MSXML2.XMLHTTP.6.0 MSXML2.XMLHTTP.5.0 MSXML2.XMLHTTP.4.0 MSXML2.XMLHTTP.3.0 MSXML2.XMLHTTP Microsoft.XMLHTTP".split(" ");return{name:"ajaxLoggingClient",send:function(b,c,d){var g=a();if(!g)throw"unable to Create ajax object Exception";
b=d(b,c);g.open("GET",b,!0);g.send()},isPrimitive:!0}});q(function(){return{name:"imageLoggingClient",send:function(a,b,c){(new window.Image).src=c(a,b)},isPrimitive:!0}});q(function(){return{name:"consoleLoggingClient",send:function(a){if(window.console&&window.console.log)window.console.log(a);else throw"Cannot Find console.log";},isPrimitive:!0}});q(function(){return{name:"chainedLoggingClient",send:function(a,b,c,d){d=n(d)?d:u;for(var g=0;g<d.length;g++)try{return v[d[g]].send(a,b,c)}catch(m){}throw"Failed to send log message using chainedLoggingClient";
},isPrimitive:!1}});g.getClientNames=function(){var a=[],b;for(b in v)a.push(b);return a};g.setConfiguration=function(c){c=c||{};"isTimberLoggingOn"in c&&(b(c.isTimberLoggingOn)?m=c.isTimberLoggingOn:a("isTimberLoggingOn must be a boolean"));"isPmetLoggingOn"in c&&(b(c.isPmetLoggingOn)?x=c.isPmetLoggingOn:a("isPmetLoggingOn must be a boolean"));c.foresterEndpoint&&e(c.foresterEndpoint)&&(D=d.trim(c.foresterEndpoint));c.timberLoggingChannel&&(e(c.timberLoggingChannel)?E=c.timberLoggingChannel:a("timberLoggingChannel must be a string"));
c.pmetPostBackChannel&&(e(c.pmetPostBackChannel)?G=c.pmetPostBackChannel:a("pmetPostBackChannel must be a string"));c.defaultClient&&(c.defaultClient in v?k=c.defaultClient:a("Specified Client not found"));"maxTimberLogCalls"in c&&(f(c.maxTimberLogCalls)&&0<c.maxTimberLogCalls?C=c.maxTimberLogCalls:a("maxTimberLogCalls must be a integer > 0"));c.defaultChainedClientExecutionOrder&&(n(c.defaultChainedClientExecutionOrder)?u=c.defaultChainedClientExecutionOrder:a("defaultChainedClientExecutionOrder must be a array of strings with names exactly matching the exsisting clients; To know the client names use getClientNames() method"));
c.isSushiEelLoggingOn&&(b(c.isSushiEelLoggingOn)?H=c.isSushiEelLoggingOn:a("isSushiEelLoggingOn must be a boolean"));c.sushiEelEndPoint&&(e(c.sushiEelEndPoint)?I=c.sushiEelEndPoint:a("sushiEelEndPoint must be a string"));c.sushiEelSourceGroup&&(e(c.sushiEelSourceGroup)?J=c.sushiEelSourceGroup:a("sushiEelSourceGroup must be a string"))};g.setPmetHeaders=function(b){if(b){s=!1;for(var c=0;c<t.length;c++)if(t[c]in b)B[t[c]]=b[t[c]];else{a(t[c]+" is not found");return}s=!0}else a("PMET headers undefined")};
g.log=function(a,b){m&&(g.numberOfTimberLogCalls++,g.numberOfTimberLogCalls===C?l("Max number of Forester Logs Reached"):g.numberOfTimberLogCalls<C&&l(a,b))};g.logLatencyMetric=function(a){x&&s&&a&&a.feature&&e(a.feature)&&a.resource&&e(a.resource)&&(p[a.feature]=p[a.feature]||{},p[a.feature][a.resource]=p[a.feature][a.resource]||[],a.startTime=a.startTime||w(),a.unit=a.unit||"ms",p[a.feature][a.resource].push({value:r()-a.startTime,unit:a.unit}))};g.logCounterMetric=function(a){if(x&&s&&a&&a.feature&&
e(a.feature)&&a.resource&&e(a.resource)){p[a.feature]=p[a.feature]||{};p[a.feature][a.resource]=p[a.feature][a.resource]||[];var b;if(b="amount"in a)b=a.amount,b=f(b)&&0<=b;a.amount=b?a.amount:1;0===p[a.feature][a.resource].length?p[a.feature][a.resource].push({value:a.amount,unit:"Count"}):p[a.feature][a.resource][0].value+=a.amount}};g.publishMetrics=function(){if(x&&s)try{var a,b="",c;for(c in p)if(p.hasOwnProperty(c)){var b=b+("/"+c+":"),d;for(d in p[c])if(p[c].hasOwnProperty(d))for(var g=0;g<
p[c][d].length;++g)b+=d+"@v="+p[c][d][g].value,p[c][d][g].unit&&(b+="|u="+p[c][d][g].unit),b+=",";b=b.substring(0,b.length-1)}if(a=b){var m;if(s){b="";for(c=0;c<t.length-1;++c)b+=t[c]+"="+B[t[c]]+"&";m=b+=t[t.length-1]+"="+B[t[t.length-1]]}else m=void 0;a+="?"+m;v.chainedLoggingClient.send(a,D+G,h);p={}}}catch(y){}};g.getCurrentTime=r;g.getWidgetStartTime=w;g.publishSushiEelMetrics=function(a){if(H)try{var b=new window.XMLHttpRequest;if(!("withCredentials"in b))throw"WithCredentials header not found Exception";
b.open("POST",I+"1/events/"+J,!0);b.send(JSON.stringify({events:[{data:a}]}))}catch(c){}};return g});k("mash-helper",["AUI!P"],function(d){return{openInExternalBrowser:function(a,f,e){d.when("mash").execute(function(b){b.openInExternalBrowser({url:a,successCallback:f,failCallback:e})})},showEmbeddedBrowser:function(a,f,e,b,c,h){d.when("mash").execute(function(d){d.showEmbeddedBrowser({targetURL:a,method:f,postParameters:e,doneButtonCallback:h,successCallback:b,failCallback:c})})},navigateToUrl:function(a){d.when("mash").execute(function(d){d.navigate({url:a})})},
clearNavigationHistory:function(){d.when("mash").execute(function(a){a.navstack.clearHistory({})})}}});k("modal-popover",["jQuery","base","AUI!P","clog"],function(d,a,f,e){return a.extend({initialize:function(a,c,d){this.widget=a;this.popoverName=c.data.popoverName;this.declarativeAction=c.data.declarativeAction;this.closeEventName=c.data.closeEventName||this.popoverName+":close";this.bindToComponent(d)},bindToComponent:function(a){var c=this,d=a.bindToElements;a.bindToElements=function(){c.bindToElements.call(c);
d.call(a)}},bindToElements:function(){var a=this,c=function(){a.widget.trigger(a.closeEventName)};f.when("A","a-modal").execute(function(d,f){var e=d.$("#"+a.declarativeAction);a.popoverInstance=f.get(e);a.popoverInstance.lock(100).show();d.on("a:declarative:a-popover-close:click",c)});a.widget.on(a.closeEventName,a,function(){a.popoverInstance&&a.popoverInstance.isActive()&&(a._hidePopoverAndOff(c),a.widget.log({popoverCloseButtonClicked:!0}),e.logCounterMetric({feature:"PopoverCloseEvent",resource:"_Count"}))});
a.widget.on("widget:clean",a,function(){var d=a.popoverInstance;d&&d.isActive()&&(delete d.typeSpecificFunctions.showMethod,delete d.typeSpecificFunctions.hideMethod,d=d.attrs("lightboxOptions"),d.showDuration=0,d.hideDuration=0,a._hidePopoverAndOff(c))})},_hidePopoverAndOff:function(a){var c=this;c.popoverInstance.unlock(100).hide();f.when("a-modal").execute(function(a){a.remove(c.declarativeAction)});f.when("A").execute(function(c){c.off("a:declarative:a-popover-close:click",a)})}})});k("number-format",
["base","lang"],function(d,a){var f={AUD:"$",BRL:"R$",CAD:"CDN$",CNY:"\u00a5",EUR:"\u20ac",GBP:"\u00a3",INR:"<span class='pmts-INR-currency-symbol'>&nbsp;&nbsp;</span>",JPY:"\u00a5",MXN:"$",RUB:"py6.",USD:"$"},e={AU:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},BR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},CA:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},CN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},DE:{fixedDecimalPrecision:2,numberDelim:".",radix:","},ES:{fixedDecimalPrecision:2,
numberDelim:".",radix:","},FR:{fixedDecimalPrecision:2,numberDelim:".",radix:","},GB:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},IT:{fixedDecimalPrecision:2,numberDelim:".",radix:","},IN:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},JP:{fixedDecimalPrecision:0,numberDelim:",",radix:"."},MX:{fixedDecimalPrecision:2,numberDelim:",",radix:"."},NL:{fixedDecimalPrecision:2,numberDelim:".",radix:","},RU:{fixedDecimalPrecision:2,numberDelim:".",radix:",",symbolAfterNumber:!0},US:{fixedDecimalPrecision:2,
numberDelim:",",radix:"."}};return d.extend({SUPPORTED_COUNTRIES:a.keys(e),initialize:function(b,c){if(-1===a.indexOf(this.SUPPORTED_COUNTRIES,b))throw Error("The country provided is invalid or not supported.");c&&c.currency&&!c.useCurrencyCode&&(c.currency=f[c.currency]);this.formatConfig=a.extend({},e[b],c)},format:function(a){var c=[],d=Number(a);if(null===a||""===a||isNaN(d))throw Error("The amount value is invalid. It must be represented as a decimal number in string format.");a=Math.abs(d);
0>d&&c.push("- ");this.formatConfig.currency&&!this.formatConfig.symbolAfterNumber&&(c.push(this.formatConfig.currency),this.formatConfig.useCurrencyCode&&c.push(" "));for(var d=a.toFixed(this.formatConfig.fixedDecimalPrecision).split("."),f=a=d[0].length,e;0<f;)e=(f-1)%3+1,c.push(d[0].substr(a-f,e)),f-=e,0<f&&c.push(this.formatConfig.numberDelim);0<this.formatConfig.fixedDecimalPrecision&&(c.push(this.formatConfig.radix),c.push(d[1]));this.formatConfig.currency&&this.formatConfig.symbolAfterNumber&&
(c.push(" "),c.push(this.formatConfig.currency));return c.join("")},localizedParseNumber:function(b){if(a.isDefined(b)){b=b.split(this.formatConfig.radix);if(2<b.length)return NaN;var c=this.formatConfig.numberDelim,d=b[0].split(c);if(2>d.length)c=b[0];else if(RegExp("^-{0,1}[1-9]{1,3}(\\"+c+"[0-9]{3})*$").test(b[0]))c=d.join("");else return NaN;return 1===b.length?Number(c):Number(c+"."+b[1])}return NaN}})});k("popover-base",["AUI!P","base","lang","jQuery"],function(d,a,f,e){return a.extend({auiOptions:null,
customOptions:null,$elem:null,initialize:function(a,c,d){this.$elem=a;this.auiOptions=c;this.customOptions=f.extend({},d)},auiShow:function(a,c,d){var e=this;c=e._defaultValue(c,{});d=e._defaultValue(d,!1);e._auiDefined(function(l){l&&(d&&(e.auiOptions={}),c=f.extend({},e.auiOptions,c),a?e._auiSet(e.$elem,c):e._auiRemove(e.$elem))})},customShow:function(a,c,d){var e=this;c=e._defaultValue(c,{});d=e._defaultValue(d,!1);e._auiDefined(function(l){l||(d&&(e.customOptions={}),c=f.extend({},e.customOptions,
c),a?e._customSet(e.$elem,c):e._customHide(e.$elem))})},_auiSet:function(a,c){d&&this.componentName&&d.when("A",this.componentName).execute(function(d,e){var f=e.get(a);f?f.update(c):e.create(a,c)})},_auiDefined:function(a){d&&d.when("A",this.componentName).execute(function(c,d){a("undefined"!==typeof d)})},_auiRemove:function(a){d&&this.componentName&&d.when("A",this.componentName).execute(function(c,d){d.remove(a)})},_customSet:function(a,c){d&&d.when("A","a-popover-base").execute(function(d,f){var l=
f.get(a);l||(l=f.show({$trigger:a,skin:function(a){return['<div class="a-popover"><div class="a-popover-wrapper">','<div class="a-popover-inner">'+a+"</div>",'<div class="a-arrow-border"><div class="a-arrow"></div></div></div></div>'].join("")},alone:!1,update:function(a){e(".a-popover-inner",this.$popover).html(a)},content:c.literalContent,position:c.position||"triggerLeft"}));l&&(l.update(c.literalContent),l.updatePosition())})},_customHide:function(a){d&&d.when("A","a-popover-base").execute(function(c,
d){d.hide(a)})},_defaultValue:function(a,c){return"undefined"!==typeof a?a:c}})});k("popover",["popover-base"],function(d){return d.extend({componentName:"a-popover"})});k("public-event-registry",["lang"],function(d){var a=[];return{register:function(f){var e=this;d.forEach(arguments,function(b){d.isString(b)&&!e.has(b)&&a.push(b)})},has:function(f){return d.isString(f)&&0<=d.indexOf(a,f)}}});k("security",["base","clog","config","jQuery"],function(d,a,f,e){function b(a){a=a.not('[name^="ppw-"]').filter(function(){return this.value&&
""!==this.value.trim()});for(var b=0;b<k.length;++b)a=a.not('[name="'+k[b]+'"]');return a}function c(c){return function(){b(c.getRootDOMElements().find("input")).each(function(b,c){var d=e(c).attr("name");a.logCounterMetric({feature:"sec.exf.",resource:d,amount:h})});a.publishMetrics()}}var h=f.getAttribute("securePage")?0:1,k=["ie"];return d.extend({initialize:function(a){var b=c(a);a.getRootDOMElements().find(":button,:submit").bind("click",b)}})});k("server",["jQuery","lang","clog"],function(d,
a,f){function e(b,c,d){c in b&&(b[c]=a.bind(b[c],d))}function b(b){var d=[];a.forEach(b,function(a){null!=a&&d.push(c(a))});return d}function c(d){if(a.isArray(d))return b(d);if(a.isObject(d)){var e={},g;for(g in d){var m=d[g];null!=m&&(e[g]=c(m))}return e}return d}function h(b){var d=a.extend({},l,b);d.data=c(b.data);d.fatal||(d.fatal=a.NOOP);d.error||(d.error=function(a,b){n&&"error"===b||d.fatal()});d.headers=a.extend(d.headers,{"Widget-Ajax-Attempt-Count":0});null==d.metricOperation&&(d.metricOperation=
d.type);return d}function k(b){var c=0,g=500+Math.floor(500*Math.random());a.has(b,"retryLimit")||(b.retryLimit=2);var m=function(a){return 0===a?g:1E3*Math.pow(2,a)},e=b.retryDelayFn?b.retryDelayFn:m,f=b.error;return function(g,m){var h=500<=g.status&&600>g.status||408===g.status||"timeout"===m||0===g.status&&0===g.readyState;401===g.status?b.fatal({type:"auth"}):!h&&f?f.apply(this,arguments):h&&c<b.retryLimit?(h=e(c),c++,b.headers=a.extend(b.headers,{"Widget-Ajax-Attempt-Count":c}),window.setTimeout(function(){d.ajax(b)},
h)):c>=b.retryLimit&&f&&f.apply(this,arguments)}}var l={contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",cache:!1,globals:!1,timeout:3E4},n=!1;d(window).bind("beforeunload",function(){n=!0});return{ajax:function(a){var b=f.getCurrentTime();n=!1;a=h(a);this._addInterceptHandlers(a,b);if(b=a.context)delete a.context,e(a,"beforeSend",b),e(a,"success",b),e(a,"error",b),e(a,"complete",b);if(b=a.query){var c=-1===a.url.indexOf("?")?"?":"&";a.url+=c+d.param(b,!0)}a.error=k(a);
a.xhrFields={withCredentials:!0};return d.ajax(a)},_addInterceptHandlers:function(b,c){a.time();a.intercept(b,"error",function(a,c,d){b.data&&b.data["ppw-widgetEvent"]&&f.logCounterMetric({feature:b.data["ppw-widgetEvent"],resource:"_ErrorCount"})},this);a.intercept(b,"complete",function(){a.time();b.data&&b.data["ppw-widgetEvent"]&&(f.logCounterMetric({feature:b.data["ppw-widgetEvent"],resource:"_Count"}),f.logLatencyMetric({feature:b.data["ppw-widgetEvent"],resource:"_Latency",startTime:c}))},this);
a.intercept(b,"success",function(){b.data&&b.data["ppw-widgetEvent"]&&f.logCounterMetric({feature:b.data["ppw-widgetEvent"],resource:"_SuccessCount"})},this)}}});k("testAjaxCapability",["clog"],function(d){return{makeCall:function(a){var d=this,e=a.options.clientId+"_testAjaxCapability";a.continueRequest({"ppw-widgetState":a.options.serializedState},{success:function(a){d.logMetric(e,0)},error:function(a){d.logMetric(e,1)},fatal:function(a){d.logMetric(e,1)}})},logMetric:function(a,f){d.logCounterMetric({feature:a,
resource:"_Count",amount:f})}}});k("tooltip",["popover-base"],function(d){return d.extend({componentName:"a-tooltip"})});k("validation-functions",["lang","number-format"],function(d,a){var f=function(a){if(!a||0===a.length)return!1;for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10},e=function(a,b){return d.some(b,function(b){return a.test(b)})},b=function(a){return d.some(a,function(a){return a&&""!==d.trim(a)})},c=function(b,c){if(void 0!==
b&&null!==b&&!0!==b&&!1!==b&&""!==d.trim(b)){var e=(new a(c)).localizedParseNumber(b);return isNaN(e)?null:e}return null},h=function(a){return a&&null!==a.match(/^[0-9]+$/)},k=function(a){a=a.getAdditionalData("isMbccFn");return d.isFunction(a)&&a()},l=function(a){var b=/^\d{3,4}$/;"AmericanExpress"===a?b=/^\d{4}$/:a&&(b=/^\d{3}$/);return b},n=function(a,b){return!b.fieldRequiredParameterName||"true"===a[b.fieldRequiredParameterName]},r=function(a,b,c){var d="";void 0!==a&&(d=a);a=b[c.defaultParameterName];
return void 0!==a&&(a=a&&a.replace(/-|\s/g,""),4<=a.length)?a.substr(a.length-d.length)===d:!1},w={NonEmptyFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];return void 0!==a&&""!==d.trim(a)},RegexMatchFieldConstraint:function(a,b,c,d){return RegExp(d.pattern).test(b[c.defaultParameterName])},NonEmptyComplexFieldConstraint:function(a,c,d){return b([c[d.defaultParameterName],c[d.radioButtonName],c[d.dropdownName]])},NumericCustomAmountRewardsAccountSelectionFieldConstraint:function(a,b,e,
f){a=f.locale.substring(3);return d.isDefined(c(b[e.customAmountSelectionInput],a))},CustomAmountLessThanOrEqualToMaxUsableRewardsAccountSelectionFieldConstraint:function(a,b,e,f){a=b[e.customAmountSelectionInput];b=f.locale.substring(3);a=c(a,b);return d.isDefined(a)&&a<=Number(f.maxUsableAmount)},CustomAmountLargerThanOrEqualToMinUsableRewardsAccountSelectionFieldConstraint:function(a,b,e,f){a=b[e.customAmountSelectionInput];b=f.locale.substring(3);a=c(a,b);return d.isDefined(a)&&a>=Number(f.minUsableAmount)},
LengthBetweenConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return a.length>=d.min&&a.length<=d.max},LengthLessThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length<=d.maximumLength},LengthGreaterThanEqualConstraint:function(a,b,c,d){return b[c.defaultParameterName].length>=d.minimumLength},LengthEqualToConstraint:function(a,b,c,d){a=b[c.defaultParameterName];return void 0!==a&&a.length===d.expectedLength},IsNumberFieldConstraint:function(a,b,c){a=b[c.defaultParameterName];
return void 0!==a&&null!==a&&!0!==a&&!1!==a&&!isNaN(a-0)&&""!==d.trim(a)},GreaterThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]>=d.min},LessThanEqualFieldConstraint:function(a,b,c,d){return b[c.defaultParameterName]<=d.max},CreditCardExpirationConstraint:function(a,b,c,d){a=b[c.combinedMonthYearParameterName];var e,f;a?(c=a.split("/"),2===c.length&&(e=parseInt(c[0].trim(),10),f=parseInt("20"+c[1].trim(),10))):(e=parseInt(b[c.monthParameterName],10),f=parseInt(b[c.yearParameterName],
10));if(isNaN(e)||isNaN(f))return!1;c=new Date(b.widgetCreationEpochMilliseconds);b=c.getUTCFullYear();c=c.getUTCMonth();return f>b&&f<=b+20||f===b&&e>=c+1},ValidCreditCardSecurityCodeConstraint:function(a,b,c){if(!n(b,c))return!0;var e=a.getAdditionalData("isCvvForMbcc");b=b[c.defaultParameterName];c=/^\d{3,4}$/;e?c=k(a)?/^\d{3,8}$/:/.*?/:(a=a.getAdditionalData("issuerFn"),a=d.isFunction(a)?a():"",c=l(a));return c.test(d.trim(b))},SelectableListValidCreditCardSecurityCodeConstraint:function(a,b,
c,e){a=b[c.defaultParameterName];return l(e.issuer).test(d.trim(a))},ValidCreditCardNumberTailConstraint:function(a,b,c){return r(a.getAdditionalData("creditCardTail"),b,c)},ValidBankAccountNumberTailConstraint:function(a,b,c){return r(a.getAdditionalData("accountNumberTail"),b,c)},ValidCreditCardNumberConstraint:function(a,b,c){a=a.getAdditionalData("isSBIMaestroFn");a=d.isFunction(a)?a():!1;b=(b=b[c.defaultParameterName])&&b.replace(/-|\s/g,"");return a?19===b.length&&f(b):11<=b.length&&19>=b.length&&
f(b)},ValidEBTCardNumberConstraint:function(a,b,c){var e=(a=b[c.defaultParameterName])&&a.replace(/-|\s/g,"");a=d.some(["600486","507714","507712"],function(a){return d.startsWith(e,a)})?h:f;return 16<=e.length&&19>=e.length&&a(e)},MatchValuesJSOnlyConstraint:function(a,b,c,d){a=b[c.defaultParameterName];b=b[d.targetFieldParameterName];return void 0!==a&&void 0!==b&&a===b},DirectDebitPrefixNotContainsDigitsConstraint:function(a,b,c,d){a=b[c.defaultParameterName];d=d.lengthParameter;return void 0!==
a&&null!==a&&null===a.substring(0,d).match(/\d+/g)},BusinessTaxIDConstraint:function(a,b,c,d){d=b[c.defaultParameterName];return w.NonEmptyFieldConstraint(a,b,c)&&2>=d.replace(/[^-]/g,"").length&&9===d.replace(/[-]/g,"").length&&/^\d+$/.test(d.replace(/[-]/g,""))},InvoiceBirthdateConstraint:function(a,b,c,d){a=parseInt(b[c.monthParameterName],10)-1;d=parseInt(b[c.dayParameterName],10)-1;c=parseInt(b[c.yearParameterName],10);var e=new Date(b.widgetCreationEpochMilliseconds);b=e.getUTCFullYear()-18;
var f=e.getUTCMonth(),e=e.getUTCDate();return a||d||c?b>c||b===c&&f>a||b===c&&f===a&&e>=d:!0},ValidPhoneNumberConstraint:function(a,b,c,e){return k(a)?(a=b[c.defaultParameterName],e=RegExp(e.pattern),!!a&&e.test(d.trim(a.replace(/[\s\(\)\-]/g,"")))):!0},ValidCreditCardPostalCodeConstraint:function(a,b,c,d){if(!n(b,c))return!0;a=b[c.defaultParameterName];d=RegExp(d.pattern);return!!a&&d.test(a)},ValidVirtualPrivateAddressConstraint:function(a,b,c){return(a=b[c.defaultParameterName])&&a.match(/^([a-zA-Z0-9\.\-]+)([@]{1})([a-zA-Z0-9\-\.]+){1,255}$/)},
RequiredNonEmptyConstraint:function(a,b,c){return n(b,c)?w.NonEmptyFieldConstraint(a,b,c):!0},RequiredValidDateConstraint:function(a,b,c,d){if(!n(b,c))return!0;a=b[c.defaultParameterName];b=d.separator;if(RegExp(d.pattern).test(a))if(b=a.split(b),d=parseInt(b[0],10),a=parseInt(b[1],10),b=parseInt(b[2],10),1E3>b||3E3<b||0===a||12<a)d=!1;else{c=[31,28,31,30,31,30,31,31,30,31,30,31];if(0===b%400||0!==b%100&&0===b%4)c[1]=29;d=0<d&&d<=c[a-1]}else d=!1;return d},ContainsOnlyDigitsConstraint:function(a,
b,c){return h(b[c.defaultParameterName])},ValidCreditCardCurrencyCodeConstraint:function(a,b,c,d){return n(b,c)?e(RegExp(d.pattern),[b[c.defaultParameterName],b[c.radioButtonName],b[c.dropdownName]]):!0}};return w});k("widget-factory",["widget","lang","config","clog","testAjaxCapability"],function(d,a,f,e,b){function c(a,c,e,f,m){a=new d(a,c,e,f,m,function(a){k(a);"true"===a.options.testAjaxAuthenticationRequired&&b.makeCall(a)});h(a);return l[c.widgetInstanceId]=a}function h(a){e.logLatencyMetric({feature:"Widget",
resource:"_Latency"});a.log({WidgetCreationTime:e.getCurrentTime()-e.getWidgetStartTime()})}function k(b){var c=b.publicProxy();f.getAttribute("onWidgetCreated")&&a.forEach(f.getAttribute("onWidgetCreated"),function(a){a(c)})}var l={};return{_widgets:l,create:function(a,b,d,e,f){var h=l[b.widgetInstanceId];h&&h.continueRequestAjaxSubstitutionEnabled?h.setup(b,d,e,f):h=c(a,b,d,e,f);return h}}});k("widget","base lang when jQuery attributes server form-helper events/form-submitted-event clog public-event-registry events/spinner-events continuable AUI!P global-event-bus events security".split(" "),
function(d,a,f,e,b,c,h,k,l,n,r,w,g,m,s,x){var K=["sif_profile"];b=d.extend(w,{initialize:function(a,b,c,d,e,f){this.type=a;if(!b.widgetInstanceId)throw Error("widgetInstanceId is required.");this.widgetInstanceId=b.widgetInstanceId;this.widgetAjaxUrlPrefixPath=b.widgetAjaxUrlPrefix?b.widgetAjaxUrlPrefix:"";this.widgetRequestPrefixPath=b.widgetRequestPrefix?b.widgetRequestPrefix+"/":"";this.setup(b,c,d,e,f,!0)},setup:function(a,b,c,d,e,f){this.off(null,this);this.offAui();m.off("AuthTimeout");s.off("AuthTimeout");
this.continueRequestAjaxSubstitutionEnabled=void 0!==a.continueRequestAjaxSubstitutionEnabled?!!a.continueRequestAjaxSubstitutionEnabled:!!this.continueRequestAjaxSubstitutionEnabled;this.components={};this.continueRequestQueue=new v;this.widgetCreationEpochMilliseconds=d;this._localizationStringsMap=c;this.pageScrolled=!1;this.options=a;this.security=new x(this);this._registerWidgetPublicEvents();e&&e(this);this.serverToClientClockDifference=this.widgetCreationEpochMilliseconds-Date.now();this.clientSideRequestTimeOffset=
0;0<this.serverToClientClockDifference?this.clientSideRequestTimeOffset=this.serverToClientClockDifference:-12E4>this.serverToClientClockDifference&&(this.clientSideRequestTimeOffset=this.serverToClientClockDifference);0!==this.clientSideRequestTimeOffset&&f&&this.publishSuccessSushiMetrics({ActionType:"ClientSideRequestTimeOffsetEvent",ActionValueType:"ClientSideRequestTimeOffset",ActionValue:this.clientSideRequestTimeOffset});this.on("AuthTimeout",this,function(a){window!==window.parent&&window.parent.PaymentsPortal2&&
window.parent.PaymentsPortal2.modules&&(window.parent.PaymentsPortal2.modules.when(["global-event-bus"],function(b){b.trigger("AuthTimeout",a)}),window.parent.PaymentsPortal2.modules.when(["events"],function(b){b.trigger("AuthTimeout",a)}))});m.on("AuthTimeout",this,function(a){this.trigger("AuthTimeout",a)});this._initializeComponents(b)},getLocalizedString:function(b,c){var d=this._localizationStringsMap[b]||"";c&&(d=a.keywordFormat(d,c));return d},publicProxy:function(){var a=this;return a._proxy?
a._proxy:a._proxy={type:a.type,on:function(b,c){a.onPublicEvent(b,c)},update:function(b){a.trigger("UpdateWidget",b)},complete:function(){a.trigger("CompleteWidget")},isContinuable:function(){return a.getContinuable()}}},onPublicEvent:function(a,b){var c=this;c.on(a,c.publicProxy(),function(){n.has(a)||c.log({publicEventConsumedButNotRegistered:a});return b.apply(c.publicProxy(),arguments)})},submitFormAJAX:function(b,c){var d=this,f;b instanceof e?(f=h.serializeObject(b),c=c||{},c.queryParameters=
this._whitelistedQueryParameters(b.get(0).action)):f=b;f["ppw-widgetState"]&&0!==f["ppw-widgetState"].trim().length?(d.trigger("submitFormAjaxStarted"),d.continueRequest(f,a.extend({},c,{success:d.createAjaxContinueSuccessHandler(c?c.success:null),complete:function(){d._fixDropdown();d.trigger("submitFormAjaxCompleted")}}))):(this.trigger(r.hideSpinner),this.fatal({type:"error",reason:"Widget state is missing in form data",feature:"MissingWidgetState"}))},_whitelistedQueryParameters:function(b){var c=
{};if(!b||-1===b.indexOf("?"))return c;b=b.substring(b.indexOf("?")+1);a.forEach(b.split("&"),function(b){b=b.split("=");0<=a.indexOf(K,b[0])&&(c[b[0]]=b[1])});return c},createAjaxContinueSuccessHandler:function(b){var c=this;return function(d){c._onAJAXContinueSuccess(d);b&&a.isFunction(b)&&b.apply(c,arguments)}},continueRequest:function(b,c){c=c?a.extend({},c):{};c.data=a.extend({},c.data?c.data:{},{"ppw-jsEnabled":!0},b);this.continueRequestQueue.enQueue(new u(this.options.customerId,c,this));
this._processContinueRequestQueue()},fatal:function(a){a=a||{type:"error"};var b="auth"===a.type?"AuthTimeout":"Fatal",c=a.feature||"AjaxContinue";"Fatal"===b&&(this.log({ajaxFatal:a}),l.logCounterMetric({feature:c,resource:"_ErrorCount"}),l.publishMetrics());this.trigger(b,a)},widgetAction:function(a){this.trigger("WidgetAction",a)},width:function(){var b=this.getRootDOMElements(),c=0,d;a.forEach(b,function(a){d=e(a);(a=d.outerWidth())&&a>c&&(c=a)});return c},height:function(){var b=this.getRootDOMElements(),
c=0,d;a.forEach(b,function(a){d=e(a);(a=d.outerHeight())&&(c+=a)});return c},scrollToElementOnInitialize:function(a){this.pageScrolled||(this.scrollToElement(e("#"+a)),this.pageScrolled=!0)},scrollToElement:function(a){a&&0<a.length&&e("html, body").animate({scrollTop:a.offset().top},"fast")},focusToElement:function(a){e("#"+a).focus()},scrollToTopOfThePage:function(){this.pageScrolled||(this.forceToScrollToTopOfThePage(),this.pageScrolled=!0)},forceToScrollToTopOfThePage:function(){e("html, body").scrollTop(0)},
_initializeComponents:function(b){var c=this,d=a.map(b,function(a){return"components/"+a.type});f(d,function(){a.forEach(arguments,function(a,d){var e=b[d],f=new a(c,e);return c.components[e.id]=f});c._onComponentsInitialized()})},_registerWidgetPublicEvents:function(){n.register("AuthTimeout","Done","Fatal",k,r.showSpinner,r.hideSpinner,"WidgetAction")},_onComponentsInitialized:function(){var b=this;e("document").ready(function(){a.forEachKeyValue(b.components,function(a,b){b.initializeOnReady()});
b._setupFormHandling();b.trigger("componentsInitialized")})},_setupFormHandling:function(){var b=this.getRootDOMElements();h.onSubmit(b.find("form").andSelf().filter("form"),a.bind(this._onFormSubmission,this))},_onFormSubmission:function(a,b,c){this.ajaxSubstitutionEnabled(a)?this._onAJAXFormSubmission(a,b,c):this._onStandardFormSubmission(a,b,c)},_onStandardFormSubmission:function(a,b,c){},_onAJAXFormSubmission:function(a,b,c){if(!b.isDefaultPrevented()){b.preventDefault();b={};if(c){var d=c.get(0).name;
""!==d&&(b[d]=c.val())}this.submitFormAJAX(a,{data:b})}},ajaxSubstitutionEnabled:function(a){a=a.get(0).getAttribute("data-pmts-ajax-continuation");return this.continueRequestAjaxSubstitutionEnabled&&(null==a||"true"===a)},setAjaxSubstitutionEnabled:function(a,b){a.attr("data-pmts-ajax-continuation",b)},_onAJAXContinueSuccess:function(a){a.htmlContent&&this._swapHtmlAndEval(a.htmlContent)},_resumeContinueRequestQueue:function(){this.processingContinueRequest=!1;this._processContinueRequestQueue()},
_processContinueRequestQueue:function(){!this.processingContinueRequest&&0<this.continueRequestQueue.length()&&this._processContinueRequest(this.continueRequestQueue.deQueue())},_processContinueRequest:function(a){this.processingContinueRequest=!0;l.publishMetrics();return c.ajax(a.options)},_handleContinueSuccess:function(a){a&&a.htmlChunks&&a.componentDataList||this.fatal();this._updateWidgetHtml(a.htmlChunks);this._attachNewComponents(a.componentDataList);this._resumeContinueRequestQueue()},_handleContinueError:function(){this.fatal()},
_attachNewComponents:function(b){var c=[];a.forEach(b,function(a){c.push(e.parseJSON(a))});this._initializeComponents(c)},_updateWidgetHtml:function(b){var c=this;a.forEachKeyValue(b,function(a,b){c._updateComponentDOM(a,b)})},_updateComponentDOM:function(a,b){var c=this.components[a];c&&(c=c.getRootDOMElements(),this._deleteComponentsInDOM(c),this._deleteComponent(a),c.first().before(b).end().remove())},_deleteComponentsInDOM:function(a){var b=this;a.find("[data-pmts-component-id]").each(function(a,
c){var d=e(c).attr("data-pmts-component-id");b._deleteComponent(d)})},_removeWidgetComponents:function(){var b=this;b.trigger("widget:clean");a.forEachKeyValue(b.components,function(a,c){c&&(c.detach(),delete b.components[a],c.getRootDOMElements().remove())})},_removeDropdownPopovers:function(){g.when("a-popover-base").execute(function(a){e(".pmts-portal-component .a-dropdown-container").each(function(){a.remove(e(this).find("select").attr("name"))})})},_deleteComponent:function(a){var b=this.components[a];
b&&(b.detach(),delete this.components[a])},getRootDOMElements:function(){return e(".pmts-portal-root-"+this.widgetInstanceId)},_getWidgetDOMAppender:function(){var b=this.getRootDOMElements();if(0===b.length)throw Error("Could not find the root dom elements of the widget in order to append new content.");var b=b.get(b.length-1),c=b.nextSibling,d=b.parentNode,e=null,e=c?function(a){d.insertBefore(a,c)}:function(a){d.appendChild(a)};return function(b){a.forEach(b,e)}},_fixDropdown:function(){var a=
this.getRootDOMElements(),b=a.find("select.a-native-dropdown").not("[data-action=a-dropdown-select]");b.length&&(a.find(".a-button-dropdown").attr("aria-hidden",!0).find(".a-button-text").removeAttr("tabindex"),b.attr({tabindex:0,"data-action":"a-dropdown-select"}).addClass("a-declarative"))},_swapHtmlAndEval:function(b){var c=[],d=[];e(b).each(function(a,b){1===b.nodeType?e(b).is("style")||(e(b).is("script:not([src])")?d.push(b):c.push(b)):c.push(b)});e(".apx-secondary-view-root-"+this.widgetInstanceId).remove();
b=this._getWidgetDOMAppender(this);this._removeWidgetComponents();this._removeDropdownPopovers();this.getRootDOMElements().remove();0<c.length&&(b(c),a.forEach(d,function(a){e.globalEval(e(a).html())}))},log:function(b){b=a.extend({customerId:this.options.customerId,widgetInstanceId:this.options.widgetInstanceId,sessionId:this.options.sessionId},b);l.log(b)},_generateWidgetRequestHeaders:function(){return{"APX-Widget-Info":[this.options.clientId,this.options.deviceType,this.options.widgetInstanceId].join("/")}},
_publishSushiMetrics:function(a){var b={ActionResult:a.ActionResult,PageLocale:this.options.locale,CustomerId:this.options.customerId,WidgetInstanceId:this.options.widgetInstanceId,WidgetDeviceType:this.options.deviceType,WidgetName:this.type,MarketplaceId:this.options.marketplaceId,Session:this.options.sessionId,PortalClientId:this.options.clientId,StartTime:Date.now()+this.clientSideRequestTimeOffset};b.RequestId=this.options.requestId?this.options.requestId:this.options.widgetInstanceId;var c=
{ActionType:null,ActionValueType:"Unspecified",ActionValue:null,ActionParentValueType:"Unspecified",ActionParentValue:null,ActionErrorCode:null},d;for(d in c)a[d]?b[d]=a[d]:c[d]&&(b[d]=c[d]);l.publishSushiEelMetrics(b)},publishFailureSushiMetrics:function(a){a.ActionResult="Failure";this._publishSushiMetrics(a)},publishSuccessSushiMetrics:function(a){a.ActionResult="Success";this._publishSushiMetrics(a)}});var u=d.extend({initialize:function(b,c,d){b=a.keywordFormat("{widgetAjaxUrlPrefixPath}/payments-portal/data/{widgetRequestPrefixPath}widgets2/v1/customer/{customerId}/continueWidget",
{customerId:b,widgetAjaxUrlPrefixPath:d.widgetAjaxUrlPrefixPath,widgetRequestPrefixPath:d.widgetRequestPrefixPath});if(c.queryParameters){var e=[];a.forEachKeyValue(c.queryParameters,function(a,b){e.push(encodeURIComponent(a)+"="+encodeURIComponent(b))});0<e.length&&(b=b+"?"+e.join("&"))}this.options=a.extend({},{type:"POST",url:b,success:a.bind(d._handleContinueSuccess,d),error:a.bind(d._handleContinueError,d),fatal:a.bind(d.fatal,d)},c);this.options.headers=a.extend({},this.options.headers,d._generateWidgetRequestHeaders());
c=function(a,b,c){return b||c&&"undefined"===typeof b?function(b,c){try{a(b,c)}finally{d._resumeContinueRequestQueue()}}:a};this.options.success=c(function(b){return function(c,e){if(c&&c.additionalWidgetResponseData){var f=c.additionalWidgetResponseData.additionalData;if(f){if("true"===f.widgetDone){var g={};a.forEachKeyValue(f,function(a,b){try{var c=JSON.parse(b);g[a]="boolean"===typeof c?b:c}catch(d){g[a]=b}});"SetPaymentPlanSelect"===d.type?d.trigger("Done",f):d.trigger("Done",g)}f.widgetAction&&
d.widgetAction(f)}}b(c,e)}}(this.options.success),this.options.resumeContinueQueueOnSuccess,!0);this.options.error=c(this.options.error,this.options.resumeContinueQueueOnError,!0);this.options.fatal=c(this.options.fatal,this.options.resumeContinueQueueOnFatal,!0)}}),v=d.extend({initialize:function(){this.items=[]},enQueue:function(a){this.items.push(a)},deQueue:function(){return this.items.shift()},length:function(){return this.items.length}});return b});k("workflow-component",["component","lang",
"public-event-registry","events/workflow-state-event"],function(d,a,f,e){return d.extend({_workflowState:void 0,initialize:function(a,c){this._workflowState=c.data.workflowState;f.register(e)},bindToEvents:function(){var a=this;a.widget.on("componentsInitialized",a,function(c){a.widget.trigger(e,a._workflowState)})}})})})();
